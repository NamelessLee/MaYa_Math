{"version":3,"sources":["error_abstract.js"],"names":["cc","Class","extends","Component","properties","OPT_HEIGHT","PAGE_NUM","item_prefab","type","Prefab","default","scroll_view","ScrollView","lbGrade","Label","onLoad","exercise","input","answer","content","opt_item_set","choose","start","bt1_clicked","JSON","parse","sys","localStorage","getItem","string","setItem","stringify","init","bt2_clicked","bt3_clicked","bt_error_exercise_clicked","director","loadScene","bt_back_clicked","removeAllChildren","length","i","item","instantiate","addChild","push","node","on","on_scroll_ended","bind","start_y","y","start_index","load_record","label1","label2","label3","label4","label5","getChildByName","color","getComponent","toString","scrollveiw_load_recode","elastic","_autoScrolling","down_loaded","out_len","up_loaded","update","dt"],"mappings":"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","file":"error_abstract.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        OPT_HEIGHT: 80, // 每项的高度\n        PAGE_NUM: 8, // 每页为8个;\n        item_prefab: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        scroll_view: {\n            type: cc.ScrollView,\n            default: null,\n        },\n\n        lbGrade: {\n            type: cc.Label,\n            default: null,\n        },\n    },\n\n    onLoad:function(){\n        this.exercise = [];\n        this.input = [];\n        this.answer = [];\n        this.content = this.scroll_view.content;\t\t\t\t\t\t//答案横坐标\n        this.opt_item_set = [];\n        this.choose;\n    },\n\n    start:function(){\n\n    },\n\n    bt1_clicked:function(){\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook1'));\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer1'));\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer1'));\n        this.lbGrade.string = \"一年级\"\n        this.choose = 1;\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\n        this.init();\n    },\n\n    bt2_clicked:function(){\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook2'));\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer2'));\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer2'));\n        this.lbGrade.string = \"二年级\"\n        this.choose = 2;\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\n        this.init();\n    },\n\n    bt3_clicked:function(){\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook3'));\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer3'));\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer3'));\n        this.lbGrade.string = \"三年级\"\n        this.choose = 3;\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\n        this.init();\n    },\n\n    bt_error_exercise_clicked:function(){\n        cc.director.loadScene(\"errorbook\")\n    },\n\n    bt_back_clicked:function(){\n        cc.director.loadScene(\"lxymenu\")\n    },\n\n    init:function(){\n        this.content.removeAllChildren();\n        this.opt_item_set.length = 0;\n        for(var i = 0; i < this.exercise.length; i ++) {\n            var item = cc.instantiate(this.item_prefab);\n            this.content.addChild(item);\n            this.opt_item_set.push(item);\n        }\n        this.scroll_view.node.on(\"scroll-ended\", this.on_scroll_ended.bind(this), this);\n        this.start_y = this.content.y;\n        this.start_index = 0;\n        this.load_record(this.start_index);\n    },\n\n    load_record: function(start_index) {\n\t\tvar label1;\n\t\tvar label2;\n\t\tvar label3;\n\t\tvar label4;\n\t\tvar label5;\n        this.start_index = start_index;\n        for(var i = 0; i < this.exercise.length; i ++) {\n            label1 = this.opt_item_set[i].getChildByName(\"num\");//题目序号\n\t\t\tlabel1.color = new cc.color(105,105,105,0);\n\t\t\tlabel2 = this.opt_item_set[i].getChildByName(\"label\");//题目内容\n\t\t\tlabel3 = this.opt_item_set[i].getChildByName(\"input\");//用户输入\n\t\t\tlabel4 = this.opt_item_set[i].getChildByName(\"answer\");//题目答案\n\t\t\tlabel5 = this.opt_item_set[i].getChildByName(\"wrong\");//是否正确\n\t\t\tlabel1.getComponent(cc.Label).string = (i+1).toString();\n\t\t\tlabel2.getComponent(cc.Label).string = this.exercise[i];\n            label4.color = new cc.color(34,139,34,0);\n            \n\t\t\tif(this.input[i]!=' '){\n\t\t\t\tlabel3.getComponent(cc.Label).string = this.input[i];\n\t\t\t\tlabel5.getComponent(cc.Label).string = \"——\";\n\t\t\t\tlabel4.getComponent(cc.Label).string = this.answer[i];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlabel3.getComponent(cc.Label).string = \"未作答\";\n\t\t\t\tlabel5.getComponent(cc.Label).string = \"\";\n\t\t\t\tlabel4.getComponent(cc.Label).string = this.answer[i];\n\t\t\t}\n        }\n    },\n\n    on_scroll_ended: function() {\n        this.scrollveiw_load_recode();\n        this.scroll_view.elastic = true;\n    },\n\n    scrollveiw_load_recode: function() {\n         // 向下加载了\n        if (this.start_index + this.PAGE_NUM * 3 < this.exercise.length &&\n            this.content.y >= this.start_y + this.PAGE_NUM * 2 * this.OPT_HEIGHT) { // 动态加载\n            \n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\n                this.scroll_view.elastic = false; // 暂时关闭回弹效果\n                return;\n            }\n\n            var down_loaded = this.PAGE_NUM;\n            this.start_index += down_loaded;\n            if (this.start_index + this.PAGE_NUM * 3 > this.exercise.length) {\n                var out_len = this.start_index + this.PAGE_NUM * 3 - this.exercise.length;\n                down_loaded -= (out_len);\n                this.start_index -= (out_len);\n            }\n            this.load_record(this.start_index);\n\n            this.content.y -= (down_loaded * this.OPT_HEIGHT);\n            return;\n        }\n\n        // 向上加载\n        if (this.start_index > 0 && this.content.y <= this.start_y) {\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\n                this.scroll_view.elastic = false;\n                return;\n            }\n\n            var up_loaded = this.PAGE_NUM;\n            this.start_index -= up_loaded;\n            if (this.start_index < 0) {\n                up_loaded += this.start_index;\n                this.start_index = 0; \n            }\n            this.load_record(this.start_index);\n            this.content.y += (up_loaded * this.OPT_HEIGHT);\n        }\n        // end \n    },\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        this.scrollveiw_load_recode();\n    },\n\n    \n\n});"]}