{"version":3,"sources":["result detail-exercise.js"],"names":["cc","Class","extends","Component","properties","OPT_HEIGHT","PAGE_NUM","item_prefab","type","Prefab","default","scroll_view","ScrollView","onLoad","exercise_done","exercise_input","exercise_rw","total","JSON","parse","sys","localStorage","getItem","allexercise","allinput","allanswer","log","rw","i","push","content","opt_item_set","item","instantiate","addChild","node","on","on_scroll_ended","bind","start","start_y","y","start_index","load_record","exseq","excontent","exinput","exanswer","exrw","getChildByName","color","getComponent","Label","string","toString","scrollveiw_load_recode","elastic","length","_autoScrolling","down_loaded","out_len","up_loaded","update","dt","back","director","loadScene"],"mappings":"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","file":"result detail-exercise.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\结果页面","sourcesContent":["/***********************************************************************************************************************************\r\n功能：用户做题之后结果的展示页面\r\n**********************************************************************************************************************************/\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        OPT_HEIGHT: 80, \t\t// 每项的高度\r\n        PAGE_NUM: 8, \t\t\t// 每页为8个;\r\n        item_prefab: {\t\t\t//预制体\r\n            type: cc.Prefab,\r\n            default: null,\r\n        },\r\n\r\n        scroll_view: {\t\t\t//题目的滚动窗口\r\n            type: cc.ScrollView,\r\n            default: null,\r\n        },\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.exercise_done = [];\t\t\t//所有做的题\r\n\t\tthis.exercise_input = [];\t\t\t//用户所有输入\r\n\t\tthis.exercise_rw = [];\t\t\t\t//用户做题情况\r\n\t\tthis.total = JSON.parse(cc.sys.localStorage.getItem('total'));\r\n\t\tthis.allexercise = JSON.parse(cc.sys.localStorage.getItem('allexercise'));\r\n\t\tthis.allinput = JSON.parse(cc.sys.localStorage.getItem('allinput'));\r\n\t\tthis.allanswer = JSON.parse(cc.sys.localStorage.getItem('allanswer'));\r\n\t\tcc.log(this.allanswer);\r\n\t\tthis.rw = JSON.parse(cc.sys.localStorage.getItem('rw'));\r\n        //向对应数组push数据;\r\n        for(var i = 0; i < this.total; i ++) {\r\n\t\t\tthis.allexercise[i] = this.allexercise[i];\r\n            this.exercise_done.push(this.allexercise[i]);\t//所有做的题\r\n\t\t\tthis.exercise_input.push(this.allinput[i]);\t\t//用户所有输入\r\n\t\t\tthis.exercise_rw.push(this.rw[i]);\t\t\t\t//用户做题情况\r\n        }\r\n\t\t\r\n        this.content = this.scroll_view.content;\t\t//答案横坐标\r\n        this.opt_item_set = [];\r\n        for(var i = 0; i < this.total; i ++) {\r\n            var item = cc.instantiate(this.item_prefab);\r\n            this.content.addChild(item);\r\n            this.opt_item_set.push(item);\r\n        }\r\n\r\n        this.scroll_view.node.on(\"scroll-ended\", this.on_scroll_ended.bind(this), this);\r\n    },\r\n\r\n    start: function() {\r\n        this.start_y = this.content.y;\r\n        this.start_index = 0; \t\t\t\t\t\t\t// 当前我们的Item加载的数据里面的起始数据记录的索引;\r\n        this.load_record(this.start_index);\r\n    },\r\n\r\n    // 从这个索引开始，加载数据记录到滚动列表里面的选项\r\n    load_record: function(start_index) {\r\n\t\tvar exseq;\r\n\t\tvar excontent;\r\n\t\tvar exinput;\r\n\t\tvar exanswer;\r\n\t\tvar exrw;\r\n        this.start_index = start_index;\r\n        for(var i = 0; i < this.total; i ++) {\r\n            exseq = this.opt_item_set[i].getChildByName(\"num\");\t\t\t\t\t//题目序号\r\n\t\t\texseq.color = new cc.color(105,105,105,0);\r\n\t\t\texcontent = this.opt_item_set[i].getChildByName(\"label\");\t\t\t//题目内容\r\n\t\t\texinput = this.opt_item_set[i].getChildByName(\"input\");\t\t\t\t//用户输入\r\n\t\t\texanswer = this.opt_item_set[i].getChildByName(\"answer\");\t\t\t//题目答案\r\n\t\t\texrw = this.opt_item_set[i].getChildByName(\"wrong\");\t\t\t\t//是否正确\r\n\t\t\texseq.getComponent(cc.Label).string = (i+1).toString();\t\t//题目序号\r\n\t\t\texcontent.getComponent(cc.Label).string = this.allexercise[i];\t//题目文本\r\n\t\t\texanswer.color = new cc.color(34,139,34,0);\r\n\t\t\tif(this.rw[i] ==0){\t\t\t\t\t\t\t\t\t\t\t\t\t//用户回答错误\r\n\t\t\t\tif(this.allinput[i]!=0){\t\t\t\t\t\t\t\t\t\t//用户是否作答\r\n\t\t\t\t\texinput.getComponent(cc.Label).string = this.allinput[i];\t\r\n\t\t\t\t\texrw.getComponent(cc.Label).string = \"——\";\t\t\t\t\t//错误答案的横线\r\n\t\t\t\t\texanswer.getComponent(cc.Label).string = this.allanswer[i];\t//正确答案\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\texinput.getComponent(cc.Label).string = \"未作答\";\t\t\t//用户未作答\r\n\t\t\t\t\texrw.getComponent(cc.Label).string = \"\";\t\t\t\t\t//未作答不需要错误答案的横线\r\n\t\t\t\t\texanswer.getComponent(cc.Label).string = this.allanswer[i];\t//正确答案\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\texinput.getComponent(cc.Label).string = this.allinput[i];\r\n\t\t\t\texinput.color = new cc.color(34,139,34,0);\r\n\t\t\t\texrw.getComponent(cc.Label).string = \"\";\r\n\t\t\t\texanswer.getComponent(cc.Label).string = \"\";\r\n\t\t\t}\r\n        }\r\n    },\r\n\r\n    on_scroll_ended: function() {\r\n        this.scrollveiw_load_recode();\r\n        this.scroll_view.elastic = true;\r\n    },\r\n\r\n    scrollveiw_load_recode: function() {\r\n         // 向下加载\r\n        if (this.start_index + this.PAGE_NUM * 3 < this.exercise_done.length &&\r\n            this.content.y >= this.start_y + this.PAGE_NUM * 2 * this.OPT_HEIGHT) { // 动态加载\r\n            \r\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n                this.scroll_view.elastic = false; // 暂时关闭回弹效果\r\n                return;\r\n            }\r\n\r\n            var down_loaded = this.PAGE_NUM;\r\n            this.start_index += down_loaded;\r\n            if (this.start_index + this.PAGE_NUM * 3 > this.exercise_done.length) {\r\n                var out_len = this.start_index + this.PAGE_NUM * 3 - this.exercise_done.length;\r\n                down_loaded -= (out_len);\r\n                this.start_index -= (out_len);\r\n            }\r\n            this.load_record(this.start_index);\r\n\r\n            this.content.y -= (down_loaded * this.OPT_HEIGHT);\r\n            return;\r\n        }\r\n\r\n        // 向上加载\r\n        if (this.start_index > 0 && this.content.y <= this.start_y) {\r\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n                this.scroll_view.elastic = false;\r\n                return;\r\n            }\r\n\r\n            var up_loaded = this.PAGE_NUM;\r\n            this.start_index -= up_loaded;\r\n            if (this.start_index < 0) {\r\n                up_loaded += this.start_index;\r\n                this.start_index = 0; \r\n            }\r\n            this.load_record(this.start_index);\r\n            this.content.y += (up_loaded * this.OPT_HEIGHT);\r\n        }\r\n        // end \r\n    },\r\n    update: function (dt) {\r\n        this.scrollveiw_load_recode();\r\n    },\r\n\t\r\n\tback: function(){//回到主菜单\r\n        cc.director.loadScene(\"lxymenu\")\r\n     },\r\n});"]}