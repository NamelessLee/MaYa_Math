{"version":3,"sources":["error_abstract.js"],"names":["cc","Class","extends","Component","properties","OPT_HEIGHT","PAGE_NUM","item_prefab","type","Prefab","default","scroll_view","ScrollView","lbGrade","Label","onLoad","exercise","input","answer","content","opt_item_set","choose","start","bt1_clicked","JSON","parse","sys","localStorage","getItem","string","setItem","stringify","init","bt2_clicked","bt3_clicked","bt_error_exercise_clicked","director","loadScene","bt_back_clicked","removeAllChildren","length","i","item","instantiate","addChild","push","node","on","on_scroll_ended","bind","start_y","y","start_index","load_record","label1","label2","label3","label4","label5","getChildByName","color","getComponent","toString","scrollveiw_load_recode","elastic","_autoScrolling","down_loaded","out_len","up_loaded","update","dt"],"mappings":"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","file":"error_abstract.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\错题本","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        OPT_HEIGHT: 80, // 每项的高度\r\n        PAGE_NUM: 8, // 每页为8个;\r\n        item_prefab: {\r\n            type: cc.Prefab,\r\n            default: null,\r\n        },\r\n\r\n        scroll_view: {\r\n            type: cc.ScrollView,\r\n            default: null,\r\n        },\r\n\r\n        lbGrade: {\r\n            type: cc.Label,\r\n            default: null,\r\n        },\r\n    },\r\n\r\n    onLoad:function(){\r\n        this.exercise = [];\r\n        this.input = [];\r\n        this.answer = [];\r\n        this.content = this.scroll_view.content;\t\t\t\t\t\t//答案横坐标\r\n        this.opt_item_set = [];\r\n        this.choose;\r\n    },\r\n\r\n    start:function(){\r\n\r\n    },\r\n\r\n    bt1_clicked:function(){\r\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook1'));\r\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer1'));\r\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer1'));\r\n        if(this.exercise==null)\r\n            this.exercise = [];\r\n        this.lbGrade.string = \"一年级\"\r\n        this.choose = 1;\r\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\r\n        this.init();\r\n    },\r\n\r\n    bt2_clicked:function(){\r\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook2'));\r\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer2'));\r\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer2'));\r\n        if(this.exercise==null)\r\n           this.exercise = [];\r\n        this.lbGrade.string = \"二年级\"\r\n        this.choose = 2;\r\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\r\n        this.init();\r\n    },\r\n\r\n    bt3_clicked:function(){\r\n        this.exercise = JSON.parse(cc.sys.localStorage.getItem('errorbook3'));\r\n        this.input = JSON.parse(cc.sys.localStorage.getItem('wronganswer3'));\r\n        this.answer = JSON.parse(cc.sys.localStorage.getItem('erbkanswer3'));\r\n        if(this.exercise==null)\r\n            this.exercise = [];\r\n        this.lbGrade.string = \"三年级\"\r\n        this.choose = 3;\r\n        cc.sys.localStorage.setItem('errorbook_choose', JSON.stringify(this.choose));\r\n        this.init();\r\n    },\r\n\r\n    bt_error_exercise_clicked:function(){\r\n        cc.director.loadScene(\"errorbook\")\r\n    },\r\n\r\n    bt_back_clicked:function(){\r\n        cc.director.loadScene(\"lxymenu\")\r\n    },\r\n\r\n    init:function(){\r\n        this.content.removeAllChildren();\r\n        this.opt_item_set.length = 0;\r\n        for(var i = 0; i < this.exercise.length; i ++) {\r\n            var item = cc.instantiate(this.item_prefab);\r\n            this.content.addChild(item);\r\n            this.opt_item_set.push(item);\r\n        }\r\n        this.scroll_view.node.on(\"scroll-ended\", this.on_scroll_ended.bind(this), this);\r\n        this.start_y = this.content.y;\r\n        this.start_index = 0;\r\n        this.load_record(this.start_index);\r\n    },\r\n\r\n    load_record: function(start_index) {\r\n\t\tvar label1;\r\n\t\tvar label2;\r\n\t\tvar label3;\r\n\t\tvar label4;\r\n\t\tvar label5;\r\n        this.start_index = start_index;\r\n        for(var i = 0; i < this.exercise.length; i ++) {\r\n            label1 = this.opt_item_set[i].getChildByName(\"num\");//题目序号\r\n\t\t\tlabel1.color = new cc.color(105,105,105,0);\r\n\t\t\tlabel2 = this.opt_item_set[i].getChildByName(\"label\");//题目内容\r\n\t\t\tlabel3 = this.opt_item_set[i].getChildByName(\"input\");//用户输入\r\n\t\t\tlabel4 = this.opt_item_set[i].getChildByName(\"answer\");//题目答案\r\n\t\t\tlabel5 = this.opt_item_set[i].getChildByName(\"wrong\");//是否正确\r\n\t\t\tlabel1.getComponent(cc.Label).string = (i+1).toString();\r\n\t\t\tlabel2.getComponent(cc.Label).string = this.exercise[i];\r\n            label4.color = new cc.color(34,139,34,0);\r\n            \r\n\t\t\tif(this.input[i]!=' '){\r\n\t\t\t\tlabel3.getComponent(cc.Label).string = this.input[i];\r\n\t\t\t\tlabel5.getComponent(cc.Label).string = \"——\";\r\n\t\t\t\tlabel4.getComponent(cc.Label).string = this.answer[i];\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tlabel3.getComponent(cc.Label).string = \"未作答\";\r\n\t\t\t\tlabel5.getComponent(cc.Label).string = \"\";\r\n\t\t\t\tlabel4.getComponent(cc.Label).string = this.answer[i];\r\n\t\t\t}\r\n        }\r\n    },\r\n\r\n    on_scroll_ended: function() {\r\n        this.scrollveiw_load_recode();\r\n        this.scroll_view.elastic = true;\r\n    },\r\n\r\n    scrollveiw_load_recode: function() {\r\n         // 向下加载了\r\n        if (this.start_index + this.PAGE_NUM * 3 < this.exercise.length &&\r\n            this.content.y >= this.start_y + this.PAGE_NUM * 2 * this.OPT_HEIGHT) { // 动态加载\r\n            \r\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n                this.scroll_view.elastic = false; // 暂时关闭回弹效果\r\n                return;\r\n            }\r\n\r\n            var down_loaded = this.PAGE_NUM;\r\n            this.start_index += down_loaded;\r\n            if (this.start_index + this.PAGE_NUM * 3 > this.exercise.length) {\r\n                var out_len = this.start_index + this.PAGE_NUM * 3 - this.exercise.length;\r\n                down_loaded -= (out_len);\r\n                this.start_index -= (out_len);\r\n            }\r\n            this.load_record(this.start_index);\r\n\r\n            this.content.y -= (down_loaded * this.OPT_HEIGHT);\r\n            return;\r\n        }\r\n\r\n        // 向上加载\r\n        if (this.start_index > 0 && this.content.y <= this.start_y) {\r\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\r\n                this.scroll_view.elastic = false;\r\n                return;\r\n            }\r\n\r\n            var up_loaded = this.PAGE_NUM;\r\n            this.start_index -= up_loaded;\r\n            if (this.start_index < 0) {\r\n                up_loaded += this.start_index;\r\n                this.start_index = 0; \r\n            }\r\n            this.load_record(this.start_index);\r\n            this.content.y += (up_loaded * this.OPT_HEIGHT);\r\n        }\r\n        // end \r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        this.scrollveiw_load_recode();\r\n    },\r\n\r\n    \r\n\r\n});"]}