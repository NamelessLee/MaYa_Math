{"version":3,"sources":["main.js"],"names":["cc","Class","extends","Component","properties","lbScore","default","type","Label","lbTime","lbSeq","questionList","Node","onLoad","A_DEFINE","B_DEFINE","C_DEFINE","a","b","c","ans","seq","timecnt","qm","result_list","error_list","JSON","parse","sys","localStorage","getItem","start","defaultGame","log","schedule","doCountTime","string","toString","generateQuestion","randnum","Math","random","questionNum","round","url","loader","loadRes","SpriteFrame","err","res","console","error","starNode","setPosition","starSprite","addComponent","Sprite","spriteFrame","addChild","A_Clicked","result","refreshScore","push","refreshSeq","B_Clicked","C_Clicked","curScore","totalScore","node","stopAllActions","runAction","sequence","scaleTo","curSeq","find","getComponent","setdata","setItem","stringify","toScene","director","loadScene"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //用于计分的Label控件\n        lbScore: {\n            default: null,\n            type: cc.Label\n        },\n        lbTime: {\n            default: null,\n            type: cc.Label\n        },\n        lbSeq: {\n            default: null,\n            type: cc.Label\n        },\n        questionList:{\n            default: null,\n            type: cc.Node\n        },\n    },\n\n    onLoad () {\n        //用于定义包剪布在代码逻辑中的代号\n        this.A_DEFINE = 0;\n        this.B_DEFINE = 1;\n        this.C_DEFINE = 2;\n        //用于记录对应出拳的得分\n        this.a = 0;\n        this.b = 0;\n        this.c = 0;\n        //题目的答案\n        this.ans = 0;\n        //记录题号\n        this.seq = 1;\n        //记录时间\n        this.timecnt = 0;\n        //记录结果\n\t\tthis.qm = 0;\n\t\t//记录题号\n        this.result_list = [];\n\t\tthis.error_list = JSON.parse(cc.sys.localStorage.getItem('userData'));\n    },\n\n    start () {\n        this.defaultGame();\n        cc.log(\"start to run\");\n        this.schedule(this.doCountTime,1);\n    },\n\n    //倒计时\n    doCountTime(){\n        //每秒更新显示信息\n        this.timecnt += 1;\n        //刷新lable\n        this.lbTime.string = this.timecnt.toString();\n        // this.lbTime.node.stopAllActions();\n        // this.lbTime.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\n    },\n\n    //重置游戏状态\n    defaultGame:function(){\n        this.b = 0;\n        this.c = 0;\n        this.a = 0;\n        this.ans = 0;\n        this.seq = 1;\n\t\t\n        //初始化显示的题目\n        this.generateQuestion();\n\t\t//cc.sys.localStorage.setItem(\"error\", error);\t\t\t//储存错题\n    },\n\n    //随机生成题目\n    generateQuestion:function(){\n        var randnum = Math.random()*149;//生成1~150的随机整数\n        var questionNum = Math.round(randnum + 1001);\n        var url = \"1/\" + questionNum.toString();\n        //记录答案\n\t\tthis.qm = randnum;         //记录题号\n        if(randnum >=1 && randnum <= 50){\n            this.ans = this.A_DEFINE;\n        }else if(randnum >=51 && randnum <= 100){\n            this.ans = this.B_DEFINE;\n        }else if(randnum >=101 && randnum <= 150){\n            this.ans = this.C_DEFINE;\n        }\n        cc.log(\"question url = \" + url);\n        cc.log(\"question answer is \" + this.ans.toString());\n        cc.loader.loadRes(url, cc.SpriteFrame, (err, res) => {\n            //加载错误则报错\n            if (err) {\n                console.error(err);\n                return;\n            }\n\n            //创建一个使用图片资源的新节点对象\n            let starNode = new cc.Node(); //创建一个新节点\n            //starNode.name = \"star1\";\n            starNode.setPosition(0,0); //创建随机的位置\n            let starSprite = starNode.addComponent(cc.Sprite); //增加精灵组件\n            starSprite.spriteFrame = res; //设置精灵组件图片资源\n            this.questionList.addChild(starNode); //场景中增加新节点\n        });\n    },\n\n    A_Clicked:function(){\n        var result = (this.A_DEFINE == this.ans);\n        if (result)\n        {\n            //成功消除计分\n            this.a += 1;\n            this.refreshScore();\n        }\n        if(result){\n            this.result_list.push(1);\n        }else{\n            this.result_list.push(0);\n\t\t\tthis.error_list.push(Math.round(this.qm));\n        }\n        this.refreshSeq();\n        if(this.seq != 31){\n            this.generateQuestion();\n\t\t\tcc.log(this.error_list.toString());\n        }\n        \n    },\n    \n    B_Clicked:function(){\n        var result = (this.B_DEFINE == this.ans);\n        if (result)\n        {\n            this.b += 1;\n            this.refreshScore();\n        }\n        if(result){\n            this.result_list.push(1);\n        }else{\n            this.result_list.push(0);\n\t\t\tthis.error_list.push(Math.round(this.qm));\n        }\n        this.refreshSeq();\n        if(this.seq != 31){\n            this.generateQuestion();\n\t\t\tcc.log(this.error_list.toString());\n        }\n    },\n    \n    C_Clicked:function(){\n        var result = (this.C_DEFINE == this.ans);\n        if (result)\n        { \n            this.c += 1;\n            this.refreshScore();\n        }\n        if(result){\n            this.result_list.push(1);\n        }else{\n            this.result_list.push(0);\n\t\t\tthis.error_list.push(Math.round(this.qm));\n        }\n        this.refreshSeq();\n        if(this.seq != 31){\n            this.generateQuestion();\n\t\t\tcc.log(this.error_list.toString());\n        }\n    },\n\n    //刷新得分\n    refreshScore:function(){\n        let curScore = this.totalScore();\n        this.lbScore.string = curScore.toString();\n        this.lbScore.node.stopAllActions();\n        this.lbScore.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\n    },\n\n    totalScore:function(){\n        return this.a + this.b + this.c;\n    },\n\n    //刷新题号\n    refreshSeq:function(){\n        let curSeq = ++this.seq;\n        if(this.seq == 31){\n            //将时间装入待传递的数据中\n            this.result_list.push(this.timecnt);\n            //获取常驻结点进行场景间通信\n            var node = cc.find('main_persistNode').getComponent('main_persist');\n            node.setdata(this.result_list);\n\t\t\tcc.sys.localStorage.setItem('userData', JSON.stringify(this.error_list));\t\t\t//存储错题到本地数据库\n            this.toScene();\n        }else{\n            this.lbSeq.string = curSeq.toString();\n            this.lbSeq.node.stopAllActions();\n            this.lbSeq.node.runAction(cc.sequence(cc.scaleTo(0.1,1.3,1.3),cc.scaleTo(0.1,1,1)));\n        }\n    },\n\n    //跳转场景\n    toScene:function(){\n        cc.director.loadScene(\"result_scene\")\n    },\n\n});"]}