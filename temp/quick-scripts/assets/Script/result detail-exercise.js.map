{"version":3,"sources":["result detail-exercise.js"],"names":["cc","Class","extends","Component","properties","OPT_HEIGHT","PAGE_NUM","item_prefab","type","Prefab","default","scroll_view","ScrollView","onLoad","value_set","value2_set","value3_set","total","JSON","parse","sys","localStorage","getItem","allexercise","allinput","allanswer","rw","i","push","content","opt_item_set","item","instantiate","addChild","node","on","on_scroll_ended","bind","start","start_y","y","start_index","load_record","log","label1","label2","label3","label4","label5","getChildByName","color","getComponent","Label","string","toString","scrollveiw_load_recode","elastic","length","_autoScrolling","down_loaded","out_len","up_loaded","update","dt","back","director","loadScene"],"mappings":"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","file":"result detail-exercise.js","sourceRoot":"../../../../assets/Script","sourcesContent":["/*\n假设世界排行榜要100个玩家的数据，我们怎么使用滚动列表来实现?\n显示[1, 100]这个数据\n(1)我们将我们滚动列表里面的每个项分成三个页\n(2)每一个页面我们制定一个数目，例如8个,根据你的scrollview的大小来决定;\n(3)总共使用的滚动列表里面的想 PAGE_NUM * 3 = 24个;\n(4) 有限的项要显示 超过它数目的数据记录?\n\n*/\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        OPT_HEIGHT: 80, // 每项的高度\n        PAGE_NUM: 8, // 每页为8个;\n        item_prefab: {\n            type: cc.Prefab,\n            default: null,\n        },\n\n        scroll_view: {\n            type: cc.ScrollView,\n            default: null,\n        },\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.value_set = [];\n\t\tthis.value2_set = [];\n\t\tthis.value3_set = [];\n\t\tthis.total = JSON.parse(cc.sys.localStorage.getItem('total'));\n\t\tthis.allexercise = JSON.parse(cc.sys.localStorage.getItem('allexercise'));\n\t\tthis.allinput = JSON.parse(cc.sys.localStorage.getItem('allinput'));\n\t\tthis.allanswer = JSON.parse(cc.sys.localStorage.getItem('allanswer'));\n\t\tthis.rw = JSON.parse(cc.sys.localStorage.getItem('rw'));\n        // 如果你这里是排行榜，那么你就push排行榜的数据;\n        for(var i = 0; i < this.total; i ++) {\n\t\t\tthis.allexercise[i] = this.allexercise[i];\n            this.value_set.push(this.allexercise[i]);\t//所有做的题\n\t\t\tthis.value2_set.push(this.allinput[i]);\t\t//用户所有输入\n\t\t\tthis.value3_set.push(this.rw[i]);\t\t\t//用户做题情况\n        }\n\t\t\n        this.content = this.scroll_view.content;\t\t\t\t\t\t//答案横坐标\n        this.opt_item_set = [];\n        for(var i = 0; i < this.total; i ++) {\n            var item = cc.instantiate(this.item_prefab);\n            this.content.addChild(item);\n            this.opt_item_set.push(item);\n        }\n\n        this.scroll_view.node.on(\"scroll-ended\", this.on_scroll_ended.bind(this), this);\n    },\n\n    start: function() {\n        this.start_y = this.content.y;\n        this.start_index = 0; // 当前我们24个Item加载的 100项数据里面的起始数据记录的索引;\n        this.load_record(this.start_index);\n    },\n\n    // 从这个索引开始，加载数据记录到我们的滚动列表里面的选项\n    load_record: function(start_index) {\n\t\tcc.log(\"你执行这里了吗\");\n\t\tvar label1;\n\t\tvar label2;\n\t\tvar label3;\n\t\tvar label4;\n\t\tvar label5;\n        this.start_index = start_index;\n        for(var i = 0; i < this.total; i ++) {\n            label1 = this.opt_item_set[i].getChildByName(\"num\");//题目序号\n\t\t\tlabel1.color = new cc.color(105,105,105,0);\n\t\t\tlabel2 = this.opt_item_set[i].getChildByName(\"label\");//题目内容\n\t\t\tlabel3 = this.opt_item_set[i].getChildByName(\"input\");//用户输入\n\t\t\tlabel4 = this.opt_item_set[i].getChildByName(\"answer\");//题目答案\n\t\t\tlabel5 = this.opt_item_set[i].getChildByName(\"wrong\");//是否正确\n\t\t\tlabel1.getComponent(cc.Label).string = (i+1).toString();\n\t\t\tlabel2.getComponent(cc.Label).string = this.allexercise[i];\n\t\t\tlabel4.color = new cc.color(34,139,34,0);\n\t\t\tif(this.rw[i] ==0){\n\t\t\t\tif(this.allinput[i]!=0){\n\t\t\t\t\tlabel3.getComponent(cc.Label).string = this.allinput[i];\n\t\t\t\t\tlabel5.getComponent(cc.Label).string = \"——\";\n\t\t\t\t\tlabel4.getComponent(cc.Label).string = this.allanswer[i];\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tlabel3.getComponent(cc.Label).string = \"未作答\";\n\t\t\t\t\tlabel5.getComponent(cc.Label).string = \"\";\n\t\t\t\t\tlabel4.getComponent(cc.Label).string = this.allanswer[i];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlabel3.getComponent(cc.Label).string = this.allinput[i];\n\t\t\t\tlabel3.color = new cc.color(34,139,34,0);\n\t\t\t\tlabel5.getComponent(cc.Label).string = \"\";\n\t\t\t\tlabel4.getComponent(cc.Label).string = \"\";\n\t\t\t}\n        }\n    },\n\n    on_scroll_ended: function() {\n        this.scrollveiw_load_recode();\n        this.scroll_view.elastic = true;\n    },\n\n    scrollveiw_load_recode: function() {\n         // 向下加载了\n        if (this.start_index + this.PAGE_NUM * 3 < this.value_set.length &&\n            this.content.y >= this.start_y + this.PAGE_NUM * 2 * this.OPT_HEIGHT) { // 动态加载\n            \n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\n                this.scroll_view.elastic = false; // 暂时关闭回弹效果\n                return;\n            }\n\n            var down_loaded = this.PAGE_NUM;\n            this.start_index += down_loaded;\n            if (this.start_index + this.PAGE_NUM * 3 > this.value_set.length) {\n                var out_len = this.start_index + this.PAGE_NUM * 3 - this.value_set.length;\n                down_loaded -= (out_len);\n                this.start_index -= (out_len);\n            }\n            this.load_record(this.start_index);\n\n            this.content.y -= (down_loaded * this.OPT_HEIGHT);\n            return;\n        }\n\n        // 向上加载\n        if (this.start_index > 0 && this.content.y <= this.start_y) {\n            if (this.scroll_view._autoScrolling) { // 等待这个自动滚动结束以后再做加载\n                this.scroll_view.elastic = false;\n                return;\n            }\n\n            var up_loaded = this.PAGE_NUM;\n            this.start_index -= up_loaded;\n            if (this.start_index < 0) {\n                up_loaded += this.start_index;\n                this.start_index = 0; \n            }\n            this.load_record(this.start_index);\n            this.content.y += (up_loaded * this.OPT_HEIGHT);\n        }\n        // end \n    },\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        this.scrollveiw_load_recode();\n    },\n\t\n\tback: function(){\n        cc.director.loadScene(\"lxymenu\")\n     },\n});"]}